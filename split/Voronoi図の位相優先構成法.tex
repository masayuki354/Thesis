\documentclass[../main]{jsarticle}
\begin{document}
\section{Voronoi図の位相優先構成法}
\subsection{位相優先構成法}
前節で調べたようにボロノイ図は、その位相的構造に着目すると、平面に埋め込まれたグラフとみなすことができる。そして母点を添加した時のボロノイ図の更新作業は、このグラフの更新作業とみなすことができる。このようにすると性質4は、このグラフの更新作業の際に満たすべき条件を述べたものとみなすことができる。すなわち、更新作業において取り除くべき部分構造は、木でなければならない。そこで、この性質を満たすことを最優先し、これに反しない場合のみ数値計算結果を採用するという方針をとる。この方針をとることで万一、数値計算結果が正しくなくても少なくともグラフ構造の操作としては矛盾なく実行できるようになるためである。
このアイデアでロバスト(頑強性)なソフトウェアを設計する技法は、${\bf 位相優先法}(topology-oriented method)と呼ばれている。\\
この方針で作られるアルゴリズム骨子は次のとおりである。$

\subsubsection*{アルゴリズム(ボロノイ図の更新作業の骨子)}
$入力:母点集合S_{l-1} = {p_1,p_2,...,p_{l-1}}に対するボロノイ図V_{l-1}と、新しい母点p_l\\
\ \ ~出力:S_l = S_{l-1} \bigcup \{ p_l \} に対するボロノイ図V_l\\
手続き: \\
（I）新しい母点p_lに最も近いボロノイ点を見つけ、その一点からなる点集合をTとおく。\\
(I \hspace{-.1em}I)Tには含まれないが、ボロノイ辺でTにつながっていてかつ次の(a),(b)を満たすボロノイ点q_{ijk}がある限り、それをTに加える。\\
~~(a)T \bigcup q_{ijk} から導出されるV_{l-1}の部分グラフはサイクルを持たない。\\
~~(b)G(p_i,p_j,p_k,p_l) < 0 である。\\
(I \hspace{-.1em}I \hspace{-.1em}I)Tに属すボロノイ点とTに属さないボロノイ点をつなぐボロノイ辺上に一つずつ新しい頂点を生成し、それらの新しい頂点を順につないでサイクルを作る。そして、このサイクルの内部に含まれる部分グラフを削除し、得られる面をp_lのボロノイ領域とみなす。\\
この手続きに従えば、ボロノイ図の更新作業は、性質４を満たすことが保証されながら実行される。\\$


そこで位相優先法で作ったボロノイ図構成ソフトウェアの振舞いの例を図７に示した。図5はランダムに配置した20個の母点に対する計算結果である。この程度の小規模なボロノイ図に対しては、誤差対策を施さないソフトウェアであっても同様の結果が得られるであろう。しかし、このソフトウェアは途中でどんな大きな数値誤差が発生しても破綻しないことが保証されている。このことを確かめるために浮動小数点計算に乱数を用いて人工的な誤差を入れてみると計算結果は図6のようになった\cite{1}。この図では辺が交差しており正しいボロノイ図にはなっていない。しかし、判定を誤っているにもかかわらず計算結果が得られていることに注目してほしい。通常のソフトウェアでは、判定を誤ると無限ループに陥ったり異常終了したりして処理が破綻することが多い。それに対して、このソフトウェアは内部で矛盾が発生することなく最後まで処理が進んで、計算結果が出力される。そして、その計算結果には「頂点と辺からなる構造は平面グラフであり、辺が交差しないように平面に描くと、領域の数は母点の数と一致する。」という性質を満たすという意味で位相的につじつまが合っている。
\end{document}